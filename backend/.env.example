# ERADS Backend - Environment Variables

# ========================
# Server Configuration
# ========================
PORT=3001
HOST=0.0.0.0
NODE_ENV=development

# ========================
# Database Configuration
# ========================
DATABASE_PATH=./data/rate_limiter.db

# ========================
# Rate Limiting Defaults
# ========================
# Default requests per window for IP-based limiting
RATE_LIMIT_DEFAULT=100
# Default window in seconds
RATE_LIMIT_WINDOW_SECONDS=60
# Use sliding window (more accurate, slightly more expensive)
RATE_LIMIT_SLIDING_WINDOW=true

# ========================
# Abuse Detection
# ========================
# Maximum requests allowed in burst window before auto-ban
ABUSE_BURST_THRESHOLD=50
# Burst detection window in seconds
ABUSE_BURST_WINDOW_SECONDS=10
# If current rate > baseline * multiplier, trigger ban
ABUSE_BURST_MULTIPLIER=5
# Default temporary ban duration in seconds (1 hour)
ABUSE_BAN_DURATION_SECONDS=3600

# ========================
# Geo Blocking
# ========================
ABUSE_GEO_BLOCKING_ENABLED=true
# Comma-separated ISO country codes to block (e.g., US,CN,RU)
ABUSE_BLOCKED_COUNTRIES=

# ========================
# Logging
# ========================
# Log level: debug, info, warn, error
LOG_LEVEL=info
# Log all requests (verbose)
LOG_ALL_REQUESTS=false

# ========================
# API Key Configuration
# ========================
# Length of generated API keys
API_KEY_LENGTH=32
# Default rate limit for new API keys
API_KEY_RATE_LIMIT=1000

# ========================
# Admin Authentication
# ========================
# Secret key for admin dashboard access
# Set this to a secure random string in production!
# Leave empty to disable auth (development only)
ADMIN_SECRET=erads_admin_secret_change_me

# ========================
# IP Intelligence
# ========================
# Cache TTL for IP reputation records (seconds)
IP_INTEL_CACHE_TTL_SECONDS=3600
# Cache TTL for ASN records (seconds)
IP_INTEL_ASN_CACHE_TTL_SECONDS=86400
# Cache TTL for provider API responses (seconds)
IP_INTEL_PROVIDER_CACHE_TTL_SECONDS=21600

# Confidence threshold for classification decisions (0-100)
IP_INTEL_CONFIDENCE_THRESHOLD=70
# Enable Tor exit node detection
IP_INTEL_TOR_DETECTION_ENABLED=true
# Enable ASN-based hosting/VPN detection
IP_INTEL_ASN_HEURISTICS_ENABLED=true

# Log all classification decisions
IP_INTEL_LOG_DECISIONS=true

# External IP Intelligence Providers (all optional)
# IPInfo.io API token
IPINFO_TOKEN=
# IP-API.com Pro key (free tier works without key)
IP_API_KEY=
# AbuseIPDB API key
ABUSEIPDB_KEY=
